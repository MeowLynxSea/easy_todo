# Easy Todo Sync Server (.env.example)
#
# Usage:
#   cp .env.example .env
#   # edit .env with your own values
#
# Notes:
# - Never commit real secrets.
# - JSON env vars can be wrapped in single quotes in `.env` files.
#   When exporting via shell/systemd, also wrap the whole JSON in single quotes.

# -----------------------------
# Server
# -----------------------------

DATABASE_URL=sqlite://./sync.db
HOST=127.0.0.1
PORT=8787

# Public origin (scheme + host + optional port). Used for OAuth callback + web UI cookies.
BASE_URL=http://127.0.0.1:8787

# Optional: show a fixed “service age” on the home page (unix ms UTC).
# SITE_CREATED_AT_MS_UTC=1700000000000

# -----------------------------
# Auth (SyncServer tokens)
# -----------------------------

# HS256 secret for access tokens + internal cookies (CHANGE IN PRODUCTION)
JWT_SECRET=dev-secret-change-me
JWT_ISSUER=easy_todo_sync_server

# Used to hash refresh tokens & tickets in DB (CHANGE IN PRODUCTION)
TOKEN_PEPPER=dev-pepper-change-me

# Allowed app redirects (comma-separated).
APP_REDIRECT_ALLOWLIST=easy_todo://auth,https://your-web.example.com/auth/callback

# Optional allowlist of enabled providers (comma-separated; default = all configured).
# AUTH_PROVIDERS=linuxdo,github

# OAuth providers (JSON array).
# Required fields: name, authorizeUrl, tokenUrl, userinfoUrl, clientId, clientSecret.
OAUTH_PROVIDERS_JSON='[{"name":"linuxdo","authorizeUrl":"https://linux.do/oauth2/authorize","tokenUrl":"https://linux.do/oauth2/token","userinfoUrl":"https://linux.do/api/user","clientId":"YOUR_CLIENT_ID","clientSecret":"YOUR_CLIENT_SECRET","scope":"read","idField":"id","accessTokenField":"access_token","tokenAuthMethod":"basic"}]'

# Optional TTLs (seconds).
ACCESS_TOKEN_TTL_SECS=900
REFRESH_TOKEN_TTL_SECS=2592000
LOGIN_ATTEMPT_TTL_SECS=600
TICKET_TTL_SECS=120

# -----------------------------
# Sync limits (optional)
# -----------------------------

# Max records per push request.
MAX_PUSH_RECORDS=500

# Optional per-user record count cap.
# MAX_RECORDS_PER_USER=50000

# -----------------------------
# Quotas / outbound traffic / subscriptions (optional)
# -----------------------------

# Storage quota counts: SUM(LENGTH(nonce) + LENGTH(ciphertext)) across records.
# If BASE_USER_STORAGE_B64 is unset, server falls back to legacy MAX_TOTAL_B64_PER_USER.
# BASE_USER_STORAGE_B64=1073741824
# MAX_TOTAL_B64_PER_USER=1073741824

# API outbound quota (bytes). Only counts `/v1/*` responses; web pages are not counted.
# BASE_USER_OUTBOUND_BYTES=10737418240

# Subscription plans (JSON array).
SUBSCRIPTION_PLANS_JSON='[{"id":"pro_30d","name":"Pro 30 Days","durationDays":30,"extraStorageB64":1073741824,"extraOutboundBytes":10737418240}]'

# -----------------------------
# Admin UI (optional)
# -----------------------------

# Enable admin UI by setting BOTH username & password.
# Recommend using a non-guessable path in production.
ADMIN_ENTRY_PATH=/admin
ADMIN_USERNAME=
ADMIN_PASSWORD=
ADMIN_SESSION_TTL_SECS=43200

# -----------------------------
# Logging (optional)
# -----------------------------

# RUST_LOG=info
